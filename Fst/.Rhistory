print("hello")
#uncomment following if needed
FstDataFrame <- read.csv(file = 'my_data.csv', header=TRUE,row.names=1)
k=7
#running OutFlank
out1 <- OutFLANK(FstDataFrame, NumberOfSamples=k)#RightTrimFraction = 0.01) #see Rstudio "help" for options to this function
#for i in $(ls); do sed '1d' $i > ${i}_fixed; done
#cat *csv_fixed > combined.csv
#example of how to use outflank. copied from https://rpubs.com/lotterhos/outflank
library(OutFLANK)
library(vcfR)
#running OutFlank
out1 <- OutFLANK(FstDataFrame, NumberOfSamples=k)#RightTrimFraction = 0.01) #see Rstudio "help" for options to this function
OutFLANKResultsPlotter(out1, withOutliers = TRUE,
NoCorr = TRUE, Hmin = 0.1, binwidth = 0.01, Zoom =
FALSE, RightZoomFraction = 0.05, titletext = NULL) #see Rstudio "help" for options to this function
#looking at outliers
outlier = OutFLANK(FstDataFrame,NumberOfSamples = k,
RightTrimFraction = 0.06, LeftTrimFraction = 0.35,
qthreshold = 0.05, Hmin = 0.1)
sum(outlier$results$qvalues<0.01, na.rm=TRUE)
plot(outlier$results$He, outlier$results$FST, pch=20, col="grey")
points(outlier$results$He[outlier$results$qvalues<0.01], outlier$results$FST[outlier$results$qvalues<0.01], pch=21, col="blue")
top_candidates <- outlier$results$qvalues<0.01 & outlier$results$He>0.1
topcan <- outlier$results[top_candidates,]
topcan[order(topcan$LocusName),]
View(topcan)
write.csv(topcan, file = "top_fst.csv")
setwd("~/Desktop/WGS/Fst")
#for i in $(ls); do sed '1d' $i > ${i}_fixed; done
#cat *csv_fixed > combined.csv
#example of how to use outflank. copied from https://rpubs.com/lotterhos/outflank
library(OutFLANK)
library(vcfR)
#inputs I need to provide. example files were downloaded from github.
vcf <- read.vcfR("sim1a.vcf", verbose=FALSE)
ind <- read.table("mypops.txt", header=TRUE) #only ind$pop is used
#Convert VCF format to SNP data format
convertVCFtoCount3 <- function(string){
# This function assumes 0 for reference
# and 1 for alternate allele
a <- as.numeric(unlist(strsplit(string, split = c("[|///]"))))
odd = seq(1, length(a), by=2)
a[odd] + a[odd+1]
}
#setting up
all.vcf.gen <- vcf@gt[,-1]
system.time(gen_table <- matrix(convertVCFtoCount3(all.vcf.gen), ncol=ncol(all.vcf.gen)))
locinames <- paste(vcf@fix[,"CHROM"], vcf@fix[,"POS"], sep="_")
SNPdata <- t(gen_table)
k<-3
FstDataFrame <- MakeDiploidFSTMat(SNPdata,locinames,ind$pop)
ind <- read.table("Pop.txt", header=TRUE) #only ind$pop is used
k <- max(ind$pop)
FstDataFrame <- MakeDiploidFSTMat(SNPdata,locinames,ind$pop)
View(ind)
View(ind)
k <- max(ind$pop)
FstDataFrame <- MakeDiploidFSTMat(SNPdata,locinames,ind$pop)
View(gen_table)
View(SNPdata)
SNPdata[is.na(SNPdata)] <- 9
FstDataFrame <- MakeDiploidFSTMat(SNPdata,locinames,ind$pop)
View(FstDataFrame)
#for i in $(ls); do sed '1d' $i > ${i}_fixed; done
#cat *csv_fixed > combined.csv
#example of how to use outflank. copied from https://rpubs.com/lotterhos/outflank
library(OutFLANK)
library(vcfR)
#inputs I need to provide. example files were downloaded from github.
vcf <- read.vcfR("sim1a.vcf", verbose=FALSE)
ind <- read.table("Pop.txt", header=TRUE) #only ind$pop is used
#Convert VCF format to SNP data format
convertVCFtoCount3 <- function(string){
# This function assumes 0 for reference
# and 1 for alternate allele
a <- as.numeric(unlist(strsplit(string, split = c("[|///]"))))
odd = seq(1, length(a), by=2)
a[odd] + a[odd+1]
}
#setting up
all.vcf.gen <- vcf@gt[,-1]
system.time(gen_table <- matrix(convertVCFtoCount3(all.vcf.gen), ncol=ncol(all.vcf.gen)))
locinames <- paste(vcf@fix[,"CHROM"], vcf@fix[,"POS"], sep="_")
SNPdata <- t(gen_table)
k <- max(ind$pop)
SNPdata[is.na(SNPdata)] <- 9
FstDataFrame <- MakeDiploidFSTMat(SNPdata,locinames,ind$pop)
View(FstDataFrame)
length(locinames)
length(SNPdata)
View(gen_table)
#inputs I need to provide. example files were downloaded from github.
vcf <- read.vcfR("sim1a.vcf", verbose=FALSE)
ind <- read.table("Pop.txt", header=TRUE) #only ind$pop is used
#Convert VCF format to SNP data format
convertVCFtoCount3 <- function(string){
# This function assumes 0 for reference
# and 1 for alternate allele
a <- as.numeric(unlist(strsplit(string, split = c("[|///]"))))
odd = seq(1, length(a), by=2)
a[odd] + a[odd+1]
}
#setting up
all.vcf.gen <- vcf@gt[,-1]
system.time(gen_table <- matrix(convertVCFtoCount3(all.vcf.gen), ncol=ncol(all.vcf.gen)))
locinames <- paste(vcf@fix[,"CHROM"], vcf@fix[,"POS"], sep="_")
SNPdata <- t(gen_table)
k <- max(ind$pop)
SNPdata[is.na(SNPdata)] <- 9
FstDataFrame <- MakeDiploidFSTMat(SNPdata,locinames,ind$pop)
#inputs I need to provide. example files were downloaded from github.
vcf <- read.vcfR("sim1a.vcf", verbose=FALSE)
View(vcf)
#setting up
all.vcf.gen <- vcf@gt[,-1]
system.time(gen_table <- matrix(convertVCFtoCount3(all.vcf.gen), ncol=ncol(all.vcf.gen)))
locinames <- paste(vcf@fix[,"CHROM"], vcf@fix[,"POS"], sep="_")
SNPdata <- t(gen_table)
k <- max(ind$pop)
SNPdata[is.na(SNPdata)] <- 9
FstDataFrame <- MakeDiploidFSTMat(SNPdata,locinames,ind$pop)
SNPdata <- t(gen_table)
temp <- SNPdata[rowSums(is.na(SNPdata))>0,]
temp
length(temp)
setwd("~/Desktop/WGS/Fst")
#inputs I need to provide. example files were downloaded from github.
vcf <- read.vcfR("sim1a.vcf", verbose=FALSE)
#setting up
all.vcf.gen <- vcf@gt[,-1]
system.time(gen_table <- matrix(convertVCFtoCount3(all.vcf.gen), ncol=ncol(all.vcf.gen)))
SNPdata <- t(gen_table)
temp <- SNPdata[rowSums(is.na(SNPdata))>0,]
length(temp)
View(vcf)
#inputs I need to provide. example files were downloaded from github.
vcf <- read.vcfR("sim1a.vcf", verbose=FALSE)
#setting up
all.vcf.gen <- vcf@gt[,-1]
system.time(gen_table <- matrix(convertVCFtoCount3(all.vcf.gen), ncol=ncol(all.vcf.gen)))
View(gen_table)
#inputs I need to provide. example files were downloaded from github.
vcf <- read.vcfR("sim1a.vcf", verbose=FALSE)
#setting up
all.vcf.gen <- vcf@gt[,-1]
system.time(gen_table <- matrix(convertVCFtoCount3(all.vcf.gen), ncol=ncol(all.vcf.gen)))
#for i in $(ls); do sed '1d' $i > ${i}_fixed; done
#cat *csv_fixed > combined.csv
#example of how to use outflank. copied from https://rpubs.com/lotterhos/outflank
library(OutFLANK)
library(vcfR)
#inputs I need to provide. example files were downloaded from github.
vcf <- read.vcfR("sim1a.vcf", verbose=FALSE)
ind <- read.table("Pop.txt", header=TRUE) #only ind$pop is used
#Convert VCF format to SNP data format
convertVCFtoCount3 <- function(string){
# This function assumes 0 for reference
# and 1 for alternate allele
a <- as.numeric(unlist(strsplit(string, split = c("[|///]"))))
odd = seq(1, length(a), by=2)
a[odd] + a[odd+1]
}
#setting up
all.vcf.gen <- vcf@gt[,-1]
system.time(gen_table <- matrix(convertVCFtoCount3(all.vcf.gen), ncol=ncol(all.vcf.gen)))
View(gen_table)
#inputs I need to provide. example files were downloaded from github.
vcf <- read.vcfR("sim1a.vcf", verbose=FALSE)
#setting up
all.vcf.gen <- vcf@gt[,-1]
system.time(gen_table <- matrix(convertVCFtoCount3(all.vcf.gen), ncol=ncol(all.vcf.gen)))
#inputs I need to provide. example files were downloaded from github.
vcf <- read.vcfR("sim1a.vcf", verbose=FALSE)
#setting up
all.vcf.gen <- vcf@gt[,-1]
system.time(gen_table <- matrix(convertVCFtoCount3(all.vcf.gen), ncol=ncol(all.vcf.gen)))
